


function E = foraging_twobuttons_setup(W)
    
    
    %% set parameters
    
    fixationColor = [ 0,0,0 ; 1,1,1 ];
    fixationSizeDeg = 0.4;
    fixationThicknessDeg = 0.1;
    fixationTextDistDeg = 8;
    
    stimNumber = 20;
    stimLambdaStart = 0.5;
    stimTau = 0.5;
    stimRepl = 0.1;
    stimDepl = 0.2;
    stimReward = +2;
    stimCost = -1;%[0,-1,-2,-4];
    stimWidthDeg = 4;
    stimDistDeg = 4;
    stimRange = 0.25;
    stimNoise = 1;
    
    targetSizeDeg = 0.2;
    targetColor = [0,0,0];
    
    cursorSizeDeg = 0.4;
    cursorColor = [255,255,255;0,255,0;255,0,0];
    cursorSpeedDegSec = 4;
    
    durFixSec = 0.5;
    durTrial = 30;
    durItiSec = 0.5;
    durPauseSec = 5;
    
    textSize = 32;
    textStyle = 0;
    textFont = 'Arial';
    textColor = 255;
    textFreqHz = 1;
    
    
    %% convert units
    
    fixationSizeRad = fixationSizeDeg*pi/180;
    fixationThicknessRad = fixationThicknessDeg*pi/180;
    fixationTextDistRad = fixationTextDistDeg*pi/180;
    stimWidthRad = stimWidthDeg*pi/180;
    stimDistRad = stimDistDeg*pi/180;
    cursorSizeRad = cursorSizeDeg*pi/180;
	cursorSpeedRadSec = cursorSpeedDegSec*pi/180;
    targetSizeRad = targetSizeDeg*pi/180;
   
    
    fixationSizeCm = W.viewingDistCm*tan(fixationSizeRad);
    fixationThicknessCm = W.viewingDistCm*tan(fixationThicknessRad);
    fixationTextDistCm = W.viewingDistCm*tan(fixationTextDistRad);
    stimWidthCm = W.viewingDistCm*tan(stimWidthRad);
    stimDistCm = W.viewingDistCm*tan(stimDistRad);
    cursorSizeCm = W.viewingDistCm*tan(cursorSizeRad);
    cursorSpeedCmSec = W.viewingDistCm*tan(cursorSpeedRadSec);
    targetSizeCm = W.viewingDistCm*tan(targetSizeRad);
    
    fixationSizePix = fixationSizeCm/W.pixSize;
    fixationThicknessPix = fixationThicknessCm/W.pixSize;
    fixationTextDistPix = fixationTextDistCm/W.pixSize;
    stimWidthPix = stimWidthCm/W.pixSize;
    stimDistPix = stimDistCm/W.pixSize;
    cursorSizePix = cursorSizeCm/W.pixSize;
    cursorSpeedPixSec = cursorSpeedCmSec/W.pixSize;
    targetSizePix = targetSizeCm/W.pixSize;
    
    cursorSpeedPixFrames = cursorSpeedPixSec/W.fps;
    
    
    %% set up design
    
    nCond = length(stimRepl)*length(stimCost);
    nTrials = nCond*stimNumber;
    
    [costList,rateList] = meshgrid(1:length(stimCost),1:length(stimRepl));
    costList = costList(randperm(nCond))';
    rateList = rateList(randperm(nCond))';
    
    
    %% generate structure
    
    E = struct(...
        'nTrials',                      nTrials , ....
        'nCond',                        nCond , ...
        'fixationColor',                fixationColor , ...
        'fixationSizeDeg',              fixationSizeDeg , ...
        'fixationThicknessDeg',         fixationThicknessDeg , ...
        'fixationTextDistDeg',          fixationTextDistDeg , ...
        'fixationSizeRad',              fixationSizeRad , ...
        'fixationThicknessRad',         fixationThicknessRad , ...
        'fixationTextDistRad',          fixationTextDistRad , ...
        'fixationSizeCm',               fixationSizeCm , ...
        'fixationThicknessCm',          fixationThicknessCm , ...
        'fixationTextDistCm',           fixationTextDistCm' , ...
        'fixationSizePix',              fixationSizePix , ...
        'fixationThicknessPix',         fixationThicknessPix , ...
        'fixationTextDistPix',        	fixationTextDistPix , ...
        'stimNumber',                   stimNumber , ...
        'stimLambdaStart',              stimLambdaStart , ...
        'stimTau',                      stimTau , ...
        'stimRepl',                     stimRepl , ...
        'stimDepl',                     stimDepl , ...
        'stimReward',                   stimReward , ...
        'stimCost',                     stimCost , ...
        'stimWidthDeg',                 stimWidthDeg , ...
        'stimDistDeg',                  stimDistDeg , ...
        'stimWidthRad',                 stimWidthRad , ...
        'stimDistRad',                  stimDistRad , ...
        'stimWidthCm',                  stimWidthCm , ...
        'stimDistCm',                   stimDistCm , ...
        'stimWidthPix',                 stimWidthPix , ...
        'stimDistPix',                  stimDistPix , ...
        'stimRange',                    stimRange , ...
        'stimNoise',                    stimNoise , ...
        'cursorColor',                  cursorColor , ...
        'cursorSizeDeg',              	cursorSizeDeg , ...
        'cursorSizeRad',              	cursorSizeRad , ...
        'cursorSizeCm',               	cursorSizeCm , ...
        'cursorSizePix',              	cursorSizePix , ...
        'cursorSpeedDegSec',          	cursorSpeedDegSec , ...
        'cursorSpeedRadSec',        	cursorSpeedRadSec , ...
        'cursorSpeedCmSec',           	cursorSpeedCmSec , ...
        'cursorSpeedPixSec',        	cursorSpeedPixSec , ...
        'cursorSpeedPixFrames',        	cursorSpeedPixFrames , ...
        'targetColor',                  targetColor , ...
        'targetSizeDeg',              	targetSizeDeg , ...
        'targetSizeRad',              	targetSizeRad , ...
        'targetSizeCm',               	targetSizeCm , ...
        'targetSizePix',              	targetSizePix , ...
        'durFixSec',                    durFixSec , ...
        'durTrial',                     durTrial , ...
        'durItiSec',                    durItiSec , ...
        'durPauseSec',                  durPauseSec , ...
        'costList',                     costList , ...
    	'rateList',                     rateList , ...
        'textSize',                     textSize , ...
        'textStyle',                    textStyle , ...
        'textFont',                     textFont , ...
        'textColor',                    textColor , ...
        'textFreqHz',                   textFreqHz ...
        );
    
    
end


